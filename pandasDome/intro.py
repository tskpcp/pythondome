import numpy as np
from pandas import Series,DataFrame,MultiIndex
def intro():
    print('求和')
    df=DataFrame([[1.4,np.nan],[7.1,-4.5],[np.nan,np.nan],[0.75,-1.3]],index=['a','b','c','d'],columns=['one','two'])
    print(df)
    print(df.sum())
    print(df.sum(axis=1))
    print('平均值')
    print(df.mean(axis=1,skipna=False))
    print(df.mean(axis=1))
    print('其他')
    print(df.idxmax())
    print(df.cumsum())
    print(df.describe())
    obj=Series(['a','a','b','c']*4)
    print(obj.describe())
    print('Serices的层次化索引')
    data=Series(np.random.randn(10),index=[['a','a','a','b','b','b','c','c','d','d'],[1,2,3,1,2,3,1,2,2,3]])
    print(data)
    print('/--------------------/')
    print(data.index)
    print('/--------------------/')
    print(data.b)
    print('/--------------------/')
    print(data['b':'c'])
    print('/--------------------/')
    print(data[:2])
    print('/--------------------/')
    print(data.unstack())
    print('/--------------------/')
    print(data.unstack().stack())
    print('DataFrame的层次化索引')
    frame=DataFrame(np.arange(12).reshape((4,3)),
                    index=[['a','a','b','b'],[1,2,1,2]],
                    columns=[['Ohio','Ohio','Colorado'],['Green','Red','Green']])
    print(frame)
    frame.index.names=['key1','key2']
    frame.columns.names=['state','color']
    print('/--------------------/')
    print(frame)
    print('/--------------------/')
    print(frame.ix['a',1])
    print('/--------------------/')
    print (frame.ix['a',2]['Colorado'])
    print('/--------------------/')
    print(frame.ix['a',2]['Ohio']['Red'])
    print('直接用MultiIndex创建层次索引结构')
    print(MultiIndex.from_arrays([['Ohio','Ohio','Colorado'],['Gree','Red','Green']],names=['state','color']))
    print('索引层级交换')
    frame_swapped=frame.swaplevel('key1','key2')
    print(frame_swapped)
    print (frame_swapped.swaplevel(0,1))
    print('根据索引排序')
    print(frame.sortlevel('key2'))
    print(frame.swaplevel(0,1).sortlevel(0))
    print('根据指定的key计算统计信息')
    print(frame.sum(level='key2'))
    print('使用列生成层次索引')
    frame=DataFrame({'a':range(7),
                     'b':range(7,0,-1),
                     'c':['one','one','one','two','two','two','two'],
                     'd':[0,1,2,0,1,2,3]})
    print(frame)
    print('/--------------------/')
    print (frame.set_index(['c','d']))
    print('/--------------------/')
    print(frame.set_index(['c','d'],drop=False))
    print('/--------------------/')
    frame2=frame.set_index(['c','d'])
    print(frame2.reset_index())